# This workflow will run tests using node and then publish a package to GitHub Packages when a release is created
# For more information see: https://help.github.com/actions/language-and-framework-guides/publishing-nodejs-packages

name: Node.js Package

on:
  push: 
    branches: main

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2
        
      - name: Bump Node Package Version
        id: package_version
      # You may pin to the exact commit or the version.
      # uses: KageKirin/bump-node-package-version@f31832006eff01a8b09319f1ec4588ae1ebdcd5d
        uses: KageKirin/bump-node-package-version@v0.0.1
        with:
          patch: true
      
      - name: Commit to new version
        run: |
          git commit -am "CI: bump version to ${{ steps.test.package_version.version }}"
          git tag -m "CI: create new tag" v${{ steps.test.package_version.version }}
          git push --follow-tags https://${{ secrets.GITHUB_TOKEN }}@github.com/ArnstadFredrik/kirkeaar

